<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper
	namespace="com.accenture.aris.inventory.business.repository.MessageRepository">
	<resultMap id="BaseResultMap"
		type="com.accenture.aris.inventory.business.entity.MessageEntity">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<result column="messageid" property="messageid" jdbcType="VARCHAR" />
		<result column="cno" property="cno" jdbcType="INTEGER" />
		<result column="userid" property="userid" jdbcType="VARCHAR" />
		<result column="text" property="text" jdbcType="VARCHAR" />
		<result column="reply" property="reply" jdbcType="INTEGER" />
	</resultMap>

	<select id="selectByMessageId" resultMap="BaseResultMap">
		select
		messageid,cno,userid,text,reply
		from t_message
		where messageid =
		#{messageid}
	</select>

	<delete id="deleteByMessageId">
		delete from t_message
		where messageid = #{messageid}
	</delete>

	<select id="messageDetail" resultMap="BaseResultMap">
		select
		messageid,cno,userid,text,reply
		from t_message
		where cno = #{0}
		and reply
		= #{1}
	</select>

	<select id="messageReply" resultMap="BaseResultMap">
		select
		messageid,cno,userid,text,reply
		from t_message , t_message_reply 
		where messageid = reply_messageid
		and target_messageid = #{messageid}
	</select>

	<insert id="createMessage"
		parameterType="com.accenture.aris.inventory.business.entity.MessageEntity">
		insert into t_message (messageid,cno,userid,text,reply)
		values
		(#{messageid}, #{cno},
		#{userid},#{text},
		#{reply})
	</insert>

	<insert id="createMessageReply">
		insert into t_message_reply
		(target_messageid,reply_messageid)
		values
		(#{0}, #{1})
	</insert>
</mapper>